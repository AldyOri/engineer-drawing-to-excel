# Engineer Drawing to Excel

A web-server application that extracts data from engineering drawings generated by AutoCAD (PDFs) and maps it into an Excel file. The application uses AI to process the drawings and extract relevant information.

## Features

- PDF file upload and processing
- Layer management in PDFs
- AI-powered data extraction
- Excel file generation with formatted output
- RESTful API endpoints
- Support for multiple PDF processing

## Prerequisites

- Node.js
- Python
- npm or yarn package manager

## Installation

1. Clone the repository:
```bash
git clone <repository-url>
cd engineer-drawing-to-excel
```

2. Install Node.js dependencies:
```bash
npm install
```

3. Set up Python environment and install dependencies:
```bash
pip install -r scripts/requirements.txt
```

4. Create `.env` file from example:
```bash
cp .env.example .env
```

5. Add your Google AI API key to `.env`:
```env
API_KEY="your-api-key-here"
```

## Building the Project

```bash
npm run build
```

## Running the Application

Development mode:
```bash
npm run dev
```

Production mode:
```bash
npm start
```

The server will start on `http://localhost:3000`

## API Documentation

> **⚠️ Important**: Never use `/api/v1/*` routes as they are deprecated and may cause unexpected behavior.

### Endpoints

#### Upload PDFs
```http
POST /api/v2/upload
Content-Type: multipart/form-data

files: File[] (PDF files)
```
- **Description**: Upload multiple PDF files for processing
- **Request Body**: Form data with multiple files under 'files' key
- **File Requirements**:
  - MIME type: application/pdf
- **Response**:
  ```json
  {
    "message": "Files uploaded successfully",
    "files": ["file1.pdf", "file2.pdf"]
  }
  ```

#### Process Files
```http
POST /api/v2/process
```
- **Description**: Process all uploaded PDFs
- **Actions**:
  - Manages PDF layers
  - Extracts first page
  - Uses AI to extract data
  - Generates Excel file
- **Response**:
  ```json
  {
    "message": "Files processed successfully",
    "outputFile": "output.xlsx"
  }
  ```

#### Download Excel
```http
GET /api/v2/download
```
- **Description**: Download the generated Excel file
- **Response**:
  - Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
  - File download: result.xlsx

## Project Structure

```
engineer-drawing-to-excel/
├── src/
│   ├── controllers/      # Request handlers
│   ├── services/         # Business logic
│   ├── utils/           # Utility functions
│   ├── interfaces/      # TypeScript interfaces
│   ├── config/          # Configuration files
│   ├── constants/       # Constants and paths
│   └── routes/          # API routes
├── scripts/
│   ├── pdf_processor.py # Python PDF processing
│   └── requirements.txt # Python dependencies
├── uploads/            # Upload directories
├── outputs/            # Generated files
└── dist/               # Compiled version of src/ directory
```

## Technical Details

- **Frontend**: None (API only)
- **Backend**: Express.js with TypeScript
- **AI Processing**: Google Generative AI (Gemini 2.0 Flash)
- **PDF Processing**: PyMuPDF (Python)
- **Excel Generation**: ExcelJS

## Environment Variables

| Variable | Description |
|----------|-------------|
| API_KEY  | Google Generative AI API key |

## Author

Aldy Nugroho